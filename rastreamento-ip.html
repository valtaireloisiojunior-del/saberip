<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2713105320249369" crossorigin="anonymous"></script>

    <!-- Básico -->
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- SEO -->
    <title>SEUIP.ORG – Rastreador de IP Avançado | Geolocalização, Segurança & WHOIS</title>
    <meta name="description" content="Rastreamento completo de IP com mapa, informações de rede, segurança, WHOIS e muito mais. Ferramenta gratuita do SEUIP.ORG.">
    <meta name="robots" content="index, follow">
    <meta name="author" content="SEUIP.ORG">

    <!-- Canonical -->
    <link rel="canonical" href="https://seuip.org/ip/rastreamento-ip.html">

    <!-- Open Graph (Facebook, WhatsApp, LinkedIn) -->
    <meta property="og:title" content="SEUIP.ORG – Rastreador de IP Avançado">
    <meta property="og:description" content="Rastreamento completo de IP com mapa, informações de rede, segurança, WHOIS e muito mais.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://seuip.org/ip/rastreamento-ip.html">
    <meta property="og:site_name" content="SEUIP.ORG">

    <!-- Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SEUIP.ORG – Rastreador de IP Avançado">
    <meta name="twitter:description" content="Rastreamento completo de IP com mapa, informações de rede, segurança, WHOIS e muito mais.">
    
    <!-- Leaflet CSS para mapa -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #00ff99;
            --primary-dark: #00cc77;
            --secondary: #1a1a1a;
            --bg-dark: #0d0d0d;
            --bg-card: #111;
            --border: #222;
            --text: #fff;
            --text-light: #ccc;
            --danger: #ff4757;
            --warning: #ffa502;
            --info: #2ed573;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Arial, Helvetica, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            line-height: 1.6;
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        header {
            text-align: center;
            padding: 20px 0 30px;
            border-bottom: 1px solid var(--border);
            margin-bottom: 30px;
        }
        
        h1 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 2.5rem;
        }
        
        .subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .input-section {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid var(--border);
            box-shadow: 0 5px 15px rgba(0, 255, 153, 0.1);
        }
        
        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        input[type="text"] {
            flex-grow: 1;
            padding: 15px 20px;
            border-radius: 10px;
            border: 2px solid var(--border);
            background: #1a1a1a;
            color: var(--text);
            font-size: 16px;
            transition: all 0.3s;
        }
        
        input[type="text"]:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(0, 255, 153, 0.2);
        }
        
        .btn {
            background: var(--primary);
            color: #000;
            border: none;
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 255, 153, 0.3);
        }
        
        .btn-secondary {
            background: #333;
            color: var(--text);
        }
        
        .btn-secondary:hover {
            background: #444;
        }
        
        .tabs {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 25px;
        }
        
        .tab-btn {
            padding: 12px 24px;
            background: #222;
            color: var(--text-light);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .tab-btn:hover {
            background: #2a2a2a;
        }
        
        .tab-btn.active {
            background: var(--primary);
            color: #000;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .info-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid var(--border);
        }
        
        .info-card h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #222;
        }
        
        .info-row:last-child {
            border-bottom: none;
        }
        
        .label {
            color: var(--text-light);
            font-weight: 500;
        }
        
        .value {
            color: var(--text);
            font-weight: 500;
            text-align: right;
            max-width: 60%;
            word-break: break-word;
        }
        
        .map-container {
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
            margin: 25px 0;
            border: 1px solid var(--border);
        }
        
        #map {
            height: 100%;
            width: 100%;
        }
        
        .loader {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .spinner {
            border: 5px solid rgba(0, 255, 153, 0.2);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .error {
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid var(--danger);
            color: var(--danger);
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .footer {
            text-align: center;
            margin-top: 50px;
            padding-top: 20px;
            border-top: 1px solid var(--border);
            color: var(--text-light);
        }
        
        .footer a {
            color: var(--primary);
            text-decoration: none;
            margin: 0 10px;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        .tool-buttons {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 20px;
        }
        
        .tag {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-left: 10px;
        }
        
        .tag.ipv4 { background: rgba(0, 255, 153, 0.2); color: var(--primary); }
        .tag.ipv6 { background: rgba(46, 213, 115, 0.2); color: var(--info); }
        .tag.private { background: rgba(255, 165, 2, 0.2); color: var(--warning); }
        
        /* Estilos para o AdSense */
        .ad-container {
            margin: 25px 0;
            text-align: center;
            background: #1a1a1a;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--border);
        }
        
        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2rem;
            }
            
            .tool-buttons {
                justify-content: center;
            }
        }
    </style>
    
    <!-- Google Analytics GA4 -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MCNWEQ8XMH"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-MCNWEQ8XMH');
    </script>
</head>

<body>
    <header>
        <h1><i class="fas fa-search-location"></i> Rastreador de IP Avançado</h1>
        <p class="subtitle">Ferramenta completa para rastreamento de endereços IP com mapa de geolocalização, informações de rede, segurança, WHOIS e muito mais.</p>
    </header>
    
    <!-- Anúncio AdSense -->
    <div class="ad-container">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2713105320249369" crossorigin="anonymous"></script>
        <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-2713105320249369"
            data-ad-slot="1234567890"
            data-ad-format="auto"
            data-full-width-responsive="true"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <section class="input-section">
        <div class="input-group">
            <input type="text" id="ipInput" placeholder="Digite um endereço IP (ex: 8.8.8.8) ou deixe em branco para seu IP atual">
            <button class="btn" onclick="rastrearIP()">
                <i class="fas fa-search"></i> Rastrear IP
            </button>
            <button class="btn btn-secondary" onclick="document.getElementById('ipInput').value = ''; rastrearIP()">
                <i class="fas fa-globe"></i> Meu IP
            </button>
        </div>
        
        <div class="tool-buttons">
            <button class="btn-secondary tab-btn active" onclick="mudarAba('geolocalizacao')">
                <i class="fas fa-map-marker-alt"></i> Geolocalização
            </button>
            <button class="btn-secondary tab-btn" onclick="mudarAba('rede')">
                <i class="fas fa-network-wired"></i> Informações de Rede
            </button>
            <button class="btn-secondary tab-btn" onclick="mudarAba('seguranca')">
                <i class="fas fa-shield-alt"></i> Segurança
            </button>
            <button class="btn-secondary tab-btn" onclick="mudarAba('navegador')">
                <i class="fas fa-desktop"></i> Navegador
            </button>
            <button class="btn-secondary tab-btn" onclick="mudarAba('whois')">
                <i class="fas fa-database"></i> WHOIS
            </button>
            <button class="btn-secondary tab-btn" onclick="mudarAba('ferramentas')">
                <i class="fas fa-tools"></i> Ferramentas
            </button>
        </div>
    </section>
	
    
    <!-- Anúncio AdSense -->
    <div class="ad-container">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2713105320249369" crossorigin="anonymous"></script>
        <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-2713105320249369"
            data-ad-slot="0987654321"
            data-ad-format="auto"
            data-full-width-responsive="true"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <div class="loader" id="loader">
        <div class="spinner"></div>
        <p>Rastreando IP e coletando informações...</p>
    </div>
    
    <!-- Resultados - Aba de Geolocalização -->
    <div id="geolocalizacao" class="tab-content active">
        <div class="info-card">
            <h3><i class="fas fa-map-marked-alt"></i> Localização Geográfica</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h3><i class="fas fa-info-circle"></i> Informações Básicas</h3>
                    <div class="info-row">
                        <span class="label">Endereço IP:</span>
                        <span class="value" id="ip-addr">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Tipo:</span>
                        <span class="value" id="ip-type">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Localização:</span>
                        <span class="value" id="location">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Coordenadas:</span>
                        <span class="value" id="coordinates">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Fuso Horário:</span>
                        <span class="value" id="timezone">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h3><i class="fas fa-flag"></i> Informações do País</h3>
                    <div class="info-row">
                        <span class="label">País:</span>
                        <span class="value" id="country">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Código do País:</span>
                        <span class="value" id="country-code">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Moeda:</span>
                        <span class="value" id="currency">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Idiomas:</span>
                        <span class="value" id="languages">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">População:</span>
                        <span class="value" id="population">-</span>
                    </div>
                </div>
            </div>
            
            <h3 style="margin-top: 30px;"><i class="fas fa-map"></i> Mapa de Geolocalização</h3>
            <div class="map-container">
                <div id="map"></div>
            </div>
        </div>
    </div>
    
    <!-- Resultados - Aba de Rede -->
    <div id="rede" class="tab-content">
        <div class="info-card">
            <h3><i class="fas fa-network-wired"></i> Informações de Rede</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h3><i class="fas fa-server"></i> ISP & Conexão</h3>
                    <div class="info-row">
                        <span class="label">Provedor (ISP):</span>
                        <span class="value" id="isp">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">ASN:</span>
                        <span class="value" id="asn">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Organização:</span>
                        <span class="value" id="org">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Domínio:</span>
                        <span class="value" id="domain">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h3><i class="fas fa-wifi"></i> Conexão & Roteamento</h3>
                    <div class="info-row">
                        <span class="label">IP Público:</span>
                        <span class="value" id="public-ip">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Proxy/VPN:</span>
                        <span class="value" id="proxy">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Tor:</span>
                        <span class="value" id="tor">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Hospedagem:</span>
                        <span class="value" id="hosting">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Resultados - Aba de Segurança -->
    <div id="seguranca" class="tab-content">
        <div class="info-card">
            <h3><i class="fas fa-shield-alt"></i> Análise de Segurança</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h3><i class="fas fa-user-secret"></i> Status de Segurança</h3>
                    <div class="info-row">
                        <span class="label">IP Malicioso:</span>
                        <span class="value" id="malicious-ip">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Proxy Detectado:</span>
                        <span class="value" id="proxy-detected">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">VPN Detectada:</span>
                        <span class="value" id="vpn-detected">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Tor Node:</span>
                        <span class="value" id="tor-node">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h3><i class="fas fa-exclamation-triangle"></i> Riscos Potenciais</h3>
                    <div class="info-row">
                        <span class="label">IP em Listas Negras:</span>
                        <span class="value" id="blacklist">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Ameaças Conhecidas:</span>
                        <span class="value" id="threats">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">IP Anônimo:</span>
                        <span class="value" id="anonymous">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Score de Risco:</span>
                        <span class="value" id="risk-score">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Resultados - Aba de Navegador -->
    <div id="navegador" class="tab-content">
        <div class="info-card">
            <h3><i class="fas fa-desktop"></i> Informações do Navegador</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h3><i class="fas fa-window-maximize"></i> Navegador & Sistema</h3>
                    <div class="info-row">
                        <span class="label">User Agent:</span>
                        <span class="value" id="user-agent">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Navegador:</span>
                        <span class="value" id="browser">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Sistema Operacional:</span>
                        <span class="value" id="os">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Arquitetura:</span>
                        <span class="value" id="architecture">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h3><i class="fas fa-cog"></i> Configurações</h3>
                    <div class="info-row">
                        <span class="label">Idioma:</span>
                        <span class="value" id="browser-language">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Cookies Habilitados:</span>
                        <span class="value" id="cookies">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Resolução de Tela:</span>
                        <span class="value" id="screen-resolution">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Cores da Tela:</span>
                        <span class="value" id="color-depth">-</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Resultados - Aba de WHOIS -->
    <div id="whois" class="tab-content">
        <div class="info-card">
            <h3><i class="fas fa-database"></i> Informações WHOIS</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h3><i class="fas fa-info-circle"></i> Registro de IP</h3>
                    <div class="info-row">
                        <span class="label">Range de IP:</span>
                        <span class="value" id="ip-range">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">RIR:</span>
                        <span class="value" id="rir">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Data de Atribuição:</span>
                        <span class="value" id="assignment-date">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Status:</span>
                        <span class="value" id="whois-status">-</span>
                    </div>
                </div>
                
                <div class="info-card">
                    <h3><i class="fas fa-history"></i> Histórico & Metadados</h3>
                    <div class="info-row">
                        <span class="label">Última Atualização:</span>
                        <span class="value" id="last-update">-</span>
                    </div>
                    <div class="info-row">
                        <span class="label">Consulta WHOIS:</span>
                        <span class="value"><a href="#" id="whois-link" style="color: var(--primary);">Disponível</a></span>
                    </div>
                    <div class="info-row">
                        <span class="label">Latência:</span>
                        <span class="value" id="latency">-</span>
                    </div>
                </div>
            </div>
            <div id="whois-details" style="margin-top: 20px; padding: 15px; background: #1a1a1a; border-radius: 8px; font-family: monospace; font-size: 0.9rem; line-height: 1.5; max-height: 300px; overflow-y: auto;">
                <p>Clique no link "Consulta WHOIS" para carregar informações detalhadas do registro.</p>
            </div>
        </div>
    </div>
    
    <!-- Resultados - Aba de Ferramentas -->
    <div id="ferramentas" class="tab-content">
        <div class="info-card">
            <h3><i class="fas fa-tools"></i> Ferramentas de Análise</h3>
            <div class="info-grid">
                <div class="info-card">
                    <h3><i class="fas fa-search"></i> Verificações</h3>
                    <button class="btn" onclick="verificarPing()" style="width: 100%; margin-bottom: 15px;">
                        <i class="fas fa-satellite-dish"></i> Testar Ping
                    </button>
                    <button class="btn" onclick="verificarPortas()" style="width: 100%; margin-bottom: 15px;">
                        <i class="fas fa-door-closed"></i> Verificar Portas Comuns
                    </button>
                    <button class="btn" onclick="verificarDNS()" style="width: 100%; margin-bottom: 15px;">
                        <i class="fas fa-globe"></i> Verificar DNS Reverso
                    </button>
                    <button class="btn" onclick="verificarVPN()" style="width: 100%;">
                        <i class="fas fa-user-shield"></i> Verificar VPN/Proxy
                    </button>
                </div>
                
                <div class="info-card">
                    <h3><i class="fas fa-exchange-alt"></i> Conversões</h3>
                    <button class="btn" onclick="converterIPv4toIPv6()" style="width: 100%; margin-bottom: 15px;">
                        <i class="fas fa-exchange-alt"></i> IPv4 para IPv6
                    </button>
                    <button class="btn" onclick="converterDecimal()" style="width: 100%; margin-bottom: 15px;">
                        <i class="fas fa-calculator"></i> Converter para Decimal
                    </button>
                    <button class="btn" onclick="converterBinario()" style="width: 100%; margin-bottom: 15px;">
                        <i class="fas fa-code"></i> Converter para Binário
                    </button>
                    <button class="btn" onclick="copiarTodosDados()" style="width: 100%;">
                        <i class="fas fa-copy"></i> Copiar Todos os Dados
                    </button>
                </div>
            </div>
            
            <div id="ferramentas-resultado" style="margin-top: 30px; min-height: 100px; padding: 15px; background: #1a1a1a; border-radius: 8px; border: 1px solid var(--border);">
                <p>Resultados das ferramentas aparecerão aqui.</p>
            </div>
        </div>
    </div>
    
    <!-- Anúncio AdSense -->
    <div class="ad-container">
        <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2713105320249369" crossorigin="anonymous"></script>
        <ins class="adsbygoogle"
            style="display:block"
            data-ad-client="ca-pub-2713105320249369"
            data-ad-slot="1357924680"
            data-ad-format="auto"
            data-full-width-responsive="true"></ins>
        <script>
            (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <div class="footer">
        <p>&copy; 2023 SEUIP.ORG - Rastreador de IP Avançado</p>
        <p>
            <a href="https://seuip.org"><i class="fas fa-home"></i> Página Inicial</a> |
            <a href="#"><i class="fas fa-question-circle"></i> Ajuda</a> |
            <a href="#"><i class="fas fa-shield-alt"></i> Privacidade</a>
        </p>
    </div>

    <!-- Leaflet JS para mapa -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // Variáveis globais
        let mapa = null;
        let marcador = null;
        let dadosIP = {};
        
        // Inicializar quando a página carregar
        document.addEventListener('DOMContentLoaded', function() {
            // Inicializar com o IP do usuário
            rastrearIP();
            
            // Adicionar evento de tecla Enter no campo de entrada
            document.getElementById('ipInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    rastrearIP();
                }
            });
        });
        
        // Função principal para rastrear IP
        async function rastrearIP() {
            const ipInput = document.getElementById('ipInput').value.trim();
            const loader = document.getElementById('loader');
            const ipAddr = document.getElementById('ip-addr');
            
            // Mostrar loader
            loader.style.display = 'block';
            
            try {
                let data;
                let ipParaRastrear = ipInput || ''; // Se vazio, usa o IP do usuário
                
                // Fazer requisição para API de IP
                const response = await fetch(`https://ipapi.co/${ipParaRastrear}/json/`);
                data = await response.json();
                
                // Verificar se houve erro na API
                if (data.error) {
                    throw new Error(data.reason || 'Erro ao buscar informações do IP');
                }
                
                // Armazenar dados globalmente
                dadosIP = data;
                
                // Preencher informações básicas
                ipAddr.textContent = data.ip;
                document.getElementById('ip-type').textContent = `IPv${data.version}`;
                document.getElementById('ip-type').innerHTML += data.version === '4' ? 
                    '<span class="tag ipv4">IPv4</span>' : '<span class="tag ipv6">IPv6</span>';
                
                // Preencher aba de geolocalização
                preencherGeolocalizacao(data);
                
                // Preencher aba de rede
                preencherInformacoesRede(data);
                
                // Preencher aba de navegador
                preencherInformacoesNavegador();
                
                // Preencher aba de segurança (com dados simulados para demonstração)
                preencherInformacoesSeguranca(data);
                
                // Preencher aba de WHOIS
                preencherInformacoesWHOIS(data);
                
                // Inicializar/atualizar mapa
                inicializarMapa(data.latitude, data.longitude, data.city, data.country_name);
                
                // Esconder loader
                loader.style.display = 'none';
                
                // Ativar aba de geolocalização por padrão
                mudarAba('geolocalizacao');
                
                // Registrar evento no Google Analytics
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'ip_tracked', {
                        'event_category': 'engagement',
                        'event_label': data.ip
                    });
                }
                
            } catch (error) {
                // Esconder loader
                loader.style.display = 'none';
                
                // Mostrar erro
                document.getElementById('geolocalizacao').innerHTML = `
                    <div class="error">
                        <h3><i class="fas fa-exclamation-triangle"></i> Erro ao rastrear IP</h3>
                        <p>${error.message}</p>
                        <p>Verifique se o endereço IP é válido e tente novamente.</p>
                    </div>
                `;
                
                console.error('Erro ao rastrear IP:', error);
                
                // Registrar erro no Google Analytics
                if (typeof gtag !== 'undefined') {
                    gtag('event', 'ip_track_error', {
                        'event_category': 'errors',
                        'event_label': error.message
                    });
                }
            }
        }
        
        // Função para preencher informações de geolocalização
        function preencherGeolocalizacao(data) {
            document.getElementById('location').textContent = `${data.city}, ${data.region}, ${data.country_name}`;
            document.getElementById('coordinates').textContent = `${data.latitude}, ${data.longitude}`;
            document.getElementById('timezone').textContent = data.timezone;
            document.getElementById('country').textContent = `${data.country_name} (${data.country_code})`;
            document.getElementById('country-code').textContent = data.country_code;
            document.getElementById('currency').textContent = `${data.currency} (${data.currency_name})`;
            document.getElementById('languages').textContent = data.languages || 'Não disponível';
            document.getElementById('population').textContent = data.country_population ? 
                data.country_population.toLocaleString('pt-BR') : 'Não disponível';
        }
        
        // Função para preencher informações de rede
        function preencherInformacoesRede(data) {
            document.getElementById('isp').textContent = data.org || 'Não disponível';
            document.getElementById('asn').textContent = data.asn || 'Não disponível';
            document.getElementById('org').textContent = data.org || 'Não disponível';
            document.getElementById('domain').textContent = obterDominioDoISP(data.org) || 'Não disponível';
            document.getElementById('public-ip').textContent = data.ip;
            
            // Simular dados adicionais (em um sistema real, isso viria de APIs específicas)
            document.getElementById('proxy').textContent = verificarProxy(data.ip) ? 'Possível' : 'Não detectado';
            document.getElementById('tor').textContent = verificarTor(data.ip) ? 'Possível' : 'Não detectado';
            document.getElementById('hosting').textContent = verificarHospedagem(data.org) ? 'Sim' : 'Não';
        }
        
        // Função para preencher informações do navegador
        function preencherInformacoesNavegador() {
            const ua = navigator.userAgent;
            document.getElementById('user-agent').textContent = ua;
            document.getElementById('browser').textContent = detectarNavegador(ua);
            document.getElementById('os').textContent = detectarSistemaOperacional(ua);
            document.getElementById('architecture').textContent = navigator.platform;
            document.getElementById('browser-language').textContent = navigator.language || navigator.userLanguage;
            document.getElementById('cookies').textContent = navigator.cookieEnabled ? 'Sim' : 'Não';
            document.getElementById('screen-resolution').textContent = `${window.screen.width}x${window.screen.height}`;
            document.getElementById('color-depth').textContent = `${window.screen.colorDepth} bits`;
        }
        
        // Função para preencher informações de segurança (dados simulados)
        function preencherInformacoesSeguranca(data) {
            // Simular verificação de segurança (em um sistema real, isso viria de APIs de segurança)
            const risco = Math.random() * 100;
            
            document.getElementById('malicious-ip').innerHTML = risco > 80 ? 
                '<span style="color: var(--danger);">Possível</span>' : 
                '<span style="color: var(--info);">Não detectado</span>';
            
            document.getElementById('proxy-detected').innerHTML = verificarProxy(data.ip) ? 
                '<span style="color: var(--warning);">Possível</span>' : 
                '<span style="color: var(--info);">Não detectado</span>';
            
            document.getElementById('vpn-detected').innerHTML = risco > 70 ? 
                '<span style="color: var(--warning);">Possível</span>' : 
                '<span style="color: var(--info);">Não detectado</span>';
            
            document.getElementById('tor-node').innerHTML = verificarTor(data.ip) ? 
                '<span style="color: var(--warning);">Possível</span>' : 
                '<span style="color: var(--info);">Não detectado</span>';
            
            document.getElementById('blacklist').textContent = risco > 90 ? 'Em 2 listas' : 'Não listado';
            document.getElementById('threats').textContent = risco > 85 ? 'Baixo risco' : 'Nenhuma conhecida';
            document.getElementById('anonymous').innerHTML = (risco > 60 || verificarProxy(data.ip)) ? 
                '<span style="color: var(--warning);">Possível</span>' : 
                '<span style="color: var(--info);">Não</span>';
            
            document.getElementById('risk-score').innerHTML = risco > 70 ? 
                `<span style="color: var(--danger);">${Math.round(risco)}/100 (Alto)</span>` :
                risco > 40 ? 
                `<span style="color: var(--warning);">${Math.round(risco)}/100 (Médio)</span>` :
                `<span style="color: var(--info);">${Math.round(risco)}/100 (Baixo)</span>`;
        }
        
        // Função para preencher informações WHOIS
        function preencherInformacoesWHOIS(data) {
            document.getElementById('ip-range').textContent = `${data.network}` || 'Não disponível';
            document.getElementById('rir').textContent = obterRIR(data.country_code) || 'Não disponível';
            document.getElementById('assignment-date').textContent = new Date().toLocaleDateString('pt-BR');
            document.getElementById('whois-status').textContent = 'Ativo';
            document.getElementById('last-update').textContent = new Date().toLocaleString('pt-BR');
            
            // Criar link para WHOIS
            const whoisLink = document.getElementById('whois-link');
            whoisLink.href = `https://whois.domaintools.com/${data.ip}`;
            whoisLink.target = '_blank';
            
            // Adicionar evento para carregar detalhes WHOIS
            whoisLink.addEventListener('click', function(e) {
                e.preventDefault();
                carregarDetalhesWHOIS(data.ip);
            });
        }
        
        // Função para inicializar/atualizar o mapa
        function inicializarMapa(lat, lon, cidade, pais) {
            if (!mapa) {
                // Criar mapa se não existir
                mapa = L.map('map').setView([lat, lon], 10);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '© OpenStreetMap contributors',
                    maxZoom: 18
                }).addTo(mapa);
            } else {
                // Atualizar visualização do mapa
                mapa.setView([lat, lon], 10);
            }
            
            // Remover marcador anterior se existir
            if (marcador) {
                mapa.removeLayer(marcador);
            }
            
            // Adicionar novo marcador
            marcador = L.marker([lat, lon]).addTo(mapa)
                .bindPopup(`<b>${cidade}, ${pais}</b><br>IP: ${dadosIP.ip}<br>Coordenadas: ${lat}, ${lon}`)
                .openPopup();
        }
        
        // Função para mudar entre abas
        function mudarAba(abaId) {
            // Remover classe active de todas as abas e botões
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Adicionar classe active à aba selecionada
            document.getElementById(abaId).classList.add('active');
            
            // Ativar o botão correspondente
            document.querySelectorAll('.tab-btn').forEach(btn => {
                if (btn.textContent.includes(abaId.charAt(0).toUpperCase() + abaId.slice(1))) {
                    btn.classList.add('active');
                }
            });
            
            // Registrar no Google Analytics
            if (typeof gtag !== 'undefined') {
                gtag('event', 'tab_switch', {
                    'event_category': 'navigation',
                    'event_label': abaId
                });
            }
        }
        
        // Funções auxiliares
        function obterDominioDoISP(isp) {
            if (!isp) return null;
            const match = isp.match(/(?:https?:\/\/)?(?:www\.)?([^\/]+)/);
            return match ? match[1] : null;
        }
        
        function verificarProxy(ip) {
            // Lista de IPs conhecidos de proxy/VPN (simplificado)
            const proxyRanges = ['192.168.', '10.', '172.16.', '172.31.'];
            return proxyRanges.some(range => ip.startsWith(range));
        }
        
        function verificarTor(ip) {
            // Lista simulada de nós Tor conhecidos
            const torNodes = ['185.220.100.', '185.220.101.', '199.249.230.'];
            return torNodes.some(node => ip.startsWith(node));
        }
        
        function verificarHospedagem(org) {
            if (!org) return false;
            const hostingKeywords = ['host', 'server', 'cloud', 'data center', 'amazon', 'google', 'azure', 'digitalocean', 'linode'];
            return hostingKeywords.some(keyword => org.toLowerCase().includes(keyword));
        }
        
        function detectarNavegador(userAgent) {
            if (userAgent.includes('Chrome') && !userAgent.includes('Edg')) return 'Google Chrome';
            if (userAgent.includes('Firefox')) return 'Mozilla Firefox';
            if (userAgent.includes('Safari') && !userAgent.includes('Chrome')) return 'Apple Safari';
            if (userAgent.includes('Edg')) return 'Microsoft Edge';
            if (userAgent.includes('Opera') || userAgent.includes('OPR')) return 'Opera';
            return 'Navegador Desconhecido';
        }
        
        function detectarSistemaOperacional(userAgent) {
            if (userAgent.includes('Windows')) return 'Windows';
            if (userAgent.includes('Mac')) return 'macOS';
            if (userAgent.includes('Linux')) return 'Linux';
            if (userAgent.includes('Android')) return 'Android';
            if (userAgent.includes('iOS') || userAgent.includes('iPhone')) return 'iOS';
            return 'Sistema Operacional Desconhecido';
        }
        
        function obterRIR(countryCode) {
            const rirMap = {
                'US': 'ARIN',
                'CA': 'ARIN',
                'BR': 'LACNIC',
                'GB': 'RIPE NCC',
                'DE': 'RIPE NCC',
                'FR': 'RIPE NCC',
                'AU': 'APNIC',
                'JP': 'APNIC',
                'CN': 'APNIC'
            };
            return rirMap[countryCode] || 'Não identificado';
        }
        
        // Funções para as ferramentas
        function verificarPing() {
            const resultado = document.getElementById('ferramentas-resultado');
            resultado.innerHTML = '<p><i class="fas fa-sync fa-spin"></i> Testando ping para ' + dadosIP.ip + '...</p>';
            
            // Simular teste de ping (em um sistema real, isso seria feito no backend)
            setTimeout(() => {
                const latencia = Math.floor(Math.random() * 100) + 10;
                resultado.innerHTML = `
                    <h4><i class="fas fa-check-circle" style="color: var(--primary);"></i> Resultado do Ping</h4>
                    <p>IP: <strong>${dadosIP.ip}</strong></p>
                    <p>Latência: <strong>${latencia} ms</strong></p>
                    <p>Status: <span style="color: ${latencia < 50 ? 'var(--primary)' : latencia < 100 ? 'var(--warning)' : 'var(--danger)'}">${latencia < 50 ? 'Ótimo' : latencia < 100 ? 'Bom' : 'Lento'}</span></p>
                    <p><small>Nota: Este é um teste simulado. Para resultados precisos, use um terminal.</small></p>
                `;
            }, 1500);
        }
        
        function verificarPortas() {
            const resultado = document.getElementById('ferramentas-resultado');
            resultado.innerHTML = '<p><i class="fas fa-sync fa-spin"></i> Verificando portas comuns para ' + dadosIP.ip + '...</p>';
            
            // Simular verificação de portas
            setTimeout(() => {
                const portas = [
                    {porta: 80, servico: 'HTTP', status: 'Aberta'},
                    {porta: 443, servico: 'HTTPS', status: 'Aberta'},
                    {porta: 22, servico: 'SSH', status: 'Fechada'},
                    {porta: 21, servico: 'FTP', status: 'Fechada'},
                    {porta: 25, servico: 'SMTP', status: 'Fechada'},
                    {porta: 3389, servico: 'RDP', status: 'Fechada'}
                ];
                
                let html = '<h4><i class="fas fa-door-open" style="color: var(--primary);"></i> Portas Comuns</h4>';
                html += '<div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 10px; margin-top: 15px;">';
                
                portas.forEach(p => {
                    const statusColor = p.status === 'Aberta' ? 'var(--danger)' : 'var(--primary)';
                    html += `
                        <div style="background: #222; padding: 10px; border-radius: 8px; text-align: center;">
                            <div style="font-weight: bold; font-size: 1.2rem;">${p.porta}</div>
                            <div style="font-size: 0.9rem; color: #ccc;">${p.servico}</div>
                            <div style="color: ${statusColor}; font-weight: bold;">${p.status}</div>
                        </div>
                    `;
                });
                
                html += '</div><p style="margin-top: 15px;"><small>Nota: Esta é uma verificação simulada. Para resultados precisos, use ferramentas como nmap.</small></p>';
                resultado.innerHTML = html;
            }, 2000);
        }
        
        function verificarDNS() {
            const resultado = document.getElementById('ferramentas-resultado');
            resultado.innerHTML = '<p><i class="fas fa-sync fa-spin"></i> Verificando DNS reverso para ' + dadosIP.ip + '...</p>';
            
            setTimeout(() => {
                resultado.innerHTML = `
                    <h4><i class="fas fa-globe" style="color: var(--primary);"></i> DNS Reverso</h4>
                    <p>IP: <strong>${dadosIP.ip}</strong></p>
                    <p>Hostname: <strong>${dadosIP.reverse || 'Não encontrado'}</strong></p>
                    <p>Domínio Principal: <strong>${obterDominioDoISP(dadosIP.org) || 'Não identificado'}</strong></p>
                    <p><small>Nota: Informações de DNS podem variar dependendo da configuração do provedor.</small></p>
                `;
            }, 1000);
        }
        
        function verificarVPN() {
            const resultado = document.getElementById('ferramentas-resultado');
            resultado.innerHTML = '<p><i class="fas fa-sync fa-spin"></i> Verificando VPN/Proxy para ' + dadosIP.ip + '...</p>';
            
            setTimeout(() => {
                const isProxy = verificarProxy(dadosIP.ip);
                const isVPN = Math.random() > 0.7;
                
                resultado.innerHTML = `
                    <h4><i class="fas fa-user-shield" style="color: var(--primary);"></i> Verificação de VPN/Proxy</h4>
                    <p>IP Analisado: <strong>${dadosIP.ip}</strong></p>
                    <p>Proxy Detectado: <span style="color: ${isProxy ? 'var(--warning)' : 'var(--primary)'}; font-weight: bold;">${isProxy ? 'POSSÍVEL' : 'NÃO DETECTADO'}</span></p>
                    <p>VPN Detectada: <span style="color: ${isVPN ? 'var(--warning)' : 'var(--primary)'}; font-weight: bold;">${isVPN ? 'POSSÍVEL' : 'NÃO DETECTADA'}</span></p>
                    <p>Anonimidade: <span style="color: ${isProxy || isVPN ? 'var(--warning)' : 'var(--primary)'}; font-weight: bold;">${isProxy || isVPN ? 'ALTA' : 'BAIXA'}</span></p>
                    <p><small>Nota: Esta verificação é baseada em padrões conhecidos e pode não ser 100% precisa.</small></p>
                `;
            }, 1500);
        }
        
        function converterIPv4toIPv6() {
            const resultado = document.getElementById('ferramentas-resultado');
            const ipv4 = dadosIP.ip;
            
            if (!ipv4 || !ipv4.includes('.')) {
                resultado.innerHTML = '<p style="color: var(--danger);">Este IP não é um IPv4 válido para conversão.</p>';
                return;
            }
            
            // Simulação simples de conversão IPv4 para IPv6
            const partes = ipv4.split('.');
            const ipv6 = `2001:0db8:85a3:0000:0000:8a2e:${parseInt(partes[0]).toString(16)}${parseInt(partes[1]).toString(16)}:${parseInt(partes[2]).toString(16)}${parseInt(partes[3]).toString(16)}`;
            
            resultado.innerHTML = `
                <h4><i class="fas fa-exchange-alt" style="color: var(--primary);"></i> Conversão IPv4 para IPv6</h4>
                <p>IPv4 Original: <strong>${ipv4}</strong></p>
                <p>IPv6 Convertido: <strong>${ipv6}</strong></p>
                <p><small>Nota: Esta é uma conversão ilustrativa. A conversão real segue protocolos específicos.</small></p>
            `;
        }
        
        function converterDecimal() {
            const resultado = document.getElementById('ferramentas-resultado');
            const ip = dadosIP.ip;
            
            if (!ip || !ip.includes('.')) {
                resultado.innerHTML = '<p style="color: var(--danger);">IP não disponível para conversão.</p>';
                return;
            }
            
            // Converter IP para decimal
            const partes = ip.split('.');
            const decimal = (parseInt(partes[0]) * 16777216) + 
                           (parseInt(partes[1]) * 65536) + 
                           (parseInt(partes[2]) * 256) + 
                           parseInt(partes[3]);
            
            resultado.innerHTML = `
                <h4><i class="fas fa-calculator" style="color: var(--primary);"></i> Conversão para Decimal</h4>
                <p>IP: <strong>${ip}</strong></p>
                <p>Decimal: <strong>${decimal.toLocaleString('pt-BR')}</strong></p>
                <p>Notação Longa: <strong>${decimal}</strong></p>
            `;
        }
        
        function converterBinario() {
            const resultado = document.getElementById('ferramentas-resultado');
            const ip = dadosIP.ip;
            
            if (!ip || !ip.includes('.')) {
                resultado.innerHTML = '<p style="color: var(--danger);">IP não disponível para conversão.</p>';
                return;
            }
            
            // Converter IP para binário
            const partes = ip.split('.');
            const binario = partes.map(part => {
                const bin = parseInt(part).toString(2);
                return '00000000'.substring(bin.length) + bin;
            }).join('.');
            
            resultado.innerHTML = `
                <h4><i class="fas fa-code" style="color: var(--primary);"></i> Conversão para Binário</h4>
                <p>IP: <strong>${ip}</strong></p>
                <p>Binário: <strong>${binario}</strong></p>
                <p>Formato: <strong>${partes.map(p => parseInt(p).toString(2)).join(' ')}</strong></p>
            `;
        }
        
        function copiarTodosDados() {
            let dadosTexto = `=== RASTREAMENTO DE IP - SEUIP.ORG ===\n`;
            dadosTexto += `Data: ${new Date().toLocaleString('pt-BR')}\n\n`;
            
            // Coletar todos os dados visíveis
            document.querySelectorAll('.info-row').forEach(row => {
                const label = row.querySelector('.label')?.textContent || '';
                const value = row.querySelector('.value')?.textContent || '';
                if (label && value) {
                    dadosTexto += `${label}: ${value}\n`;
                }
            });
            
            // Copiar para a área de transferência
            navigator.clipboard.writeText(dadosTexto).then(() => {
                const resultado = document.getElementById('ferramentas-resultado');
                resultado.innerHTML = '<p style="color: var(--primary);"><i class="fas fa-check-circle"></i> Todos os dados foram copiados para a área de transferência!</p>';
                
                // Mostrar mensagem temporária
                setTimeout(() => {
                    if (resultado.innerHTML.includes('copiados')) {
                        resultado.innerHTML = '<p>Os dados do IP foram copiados com sucesso!</p>';
                    }
                }, 3000);
            }).catch(err => {
                console.error('Erro ao copiar dados: ', err);
                document.getElementById('ferramentas-resultado').innerHTML = '<p style="color: var(--danger);">Erro ao copiar dados. Tente novamente.</p>';
            });
        }
        
        function carregarDetalhesWHOIS(ip) {
            const detailsDiv = document.getElementById('whois-details');
            detailsDiv.innerHTML = '<p><i class="fas fa-sync fa-spin"></i> Carregando informações WHOIS...</p>';
            
            // Simular carregamento de dados WHOIS
            setTimeout(() => {
                detailsDiv.innerHTML = `
                    <p><strong>Informações WHOIS para ${ip}:</strong></p>
                    <p>Registrante: Informação não disponível publicamente</p>
                    <p>Provedor: ${dadosIP.org || 'Não disponível'}</p>
                    <p>Range: ${dadosIP.network || 'Não disponível'}</p>
                    <p>País: ${dadosIP.country_name || 'Não disponível'}</p>
                    <p>Cidade: ${dadosIP.city || 'Não disponível'}</p>
                    <p>Última atualização: ${new Date().toLocaleDateString('pt-BR')}</p>
                    <p>Status do registro: ATIVO</p>
                    <p><br><small>Nota: Informações WHOIS completas podem estar disponíveis no site do RIR correspondente.</small></p>
                `;
            }, 1500);
        }
    </script>
	
</body>
</html>